doctype html
html(lang="en")
    head
        meta(charset="utf-8")
        title Draw Shapes
        script(src="../build/bu.js")
        script(src="js/vue.min.js")
        script(src="js/vue-importer.js")
        script(src="js/ClipMeter.min.js")
        
        script(src="./lib/reactor/ReactorBase.js")
        script(src="./lib/reactor/MovePointReactor.js")
        script(src="./lib/reactor/ReactorBase.js")
        script(src="./lib/reactor/DrawPointReactor.js")
        script(src="./lib/reactor/DrawCircleReactor.js")
        script(src="./lib/reactor/DrawCircleDiameterReactor.js")
        script(src="./lib/reactor/DrawPolylineReactor.js")
        script(src="./lib/reactor/DrawPolygonReactor.js")
        script(src="./lib/reactor/DrawFreelineReactor.js")

        style.
            * {
                margin: 0;
                padding: 0;
                -webkit-user-drag: none;
                -webkit-user-select: none;
            }

            html, body, #app {
                height: 100%;
            }

            span {
                vertical-align: top;
            }

            #app {
                display: inline-flex;
                width: 100%;
            }

            #app.theme-dark {
                background-color: #444;
                color: #eee;
            }

            #container {
                display: inline-block;
                width: calc(100% - 42px);
                overflow: hidden;
            }

            #info {
                position: absolute;
                width: 90%;
                text-align: center;
                padding: 8px 0;
            }
body

div#app.theme-light(:class="theme")
    side-panel
        vertical-toolbar(v-ref:toolbar)
    div#container
        div#info
            label
                input(type="checkbox" onclick="bu.isShowKeyPoints = this.checked;" checked)
                | Show key points

script.

    var bu;
    var reactors = {};

    var iconButtons = [
        {
            icon: './vue/icons/point.png',
            tip: "Point",
            key: 'point',
            selected: true
        }, {
            icon: './vue/icons/circle.png',
            tip: "Circle",
            key: 'circle',
            selected: false
        }, {
            icon: './vue/icons/circle2.png',
            tip: "Circle2",
            key: 'circle2',
            selected: false
        }, {
            icon: './vue/icons/polygon.png',
            tip: "Polygon",
            key: 'polygon',
            selected: false
        }, {
            icon: './vue/icons/polyline.png',
            tip: "Polyline",
            key: 'polyline',
            selected: false
        }, {
            icon: './vue/icons/freeline.png',
            tip: "Freeline",
            key: 'freeline',
            selected: false
        }, {
            icon: './vue/icons/freeline.png',
            tip: "Smooth Freeline",
            key: 'smoothFreeline',
            selected: false
        }
    ];

    VueImporter.load([
        'image-button',
        'vertical-toolbar',
        'side-panel'
    ], function () {
        new Vue({
            el: '#app',
            props: ['theme'],
            events: {
                toolChanged: function (keyOn) {
                    for (var key in reactors) {
                        if (!reactors.hasOwnProperty(key)) continue;
                        if (key === keyOn)
                            reactors[key].enable();
                        else
                            reactors[key].disable();
                    }
                }
            },
            ready: function () {
                this.$refs.toolbar.items = iconButtons;
                bu = new Bu({
                    container: "#container",
                    fillParent: true,
                    border: false,
                    showKeyPoints: true
                });

                reactors.point = new Bu.DrawPointReactor(bu);
                reactors.circle = new Bu.DrawCircleReactor(bu);
                reactors.circle2 = new Bu.DrawCircleDiameterReactor(bu);
                reactors.polyline = new Bu.DrawPolylineReactor(bu);
                reactors.polygon = new Bu.DrawPolygonReactor(bu);
                reactors.freeline = new Bu.DrawFreelineReactor(bu);
                reactors.smoothFreeline = new Bu.DrawFreelineReactor(bu, true);

                reactors.point.enable();
            }
        })
    });
