doctype html
html
	head
		meta(charset="utf-8")
		title Distance from Point to Line
		script(src="../build/bu.js")
		style.

			html, body {
				margin: 0;
				width: 100%;
				height: 100%;
				overflow: hidden;
			}

			#info {
				position: absolute;
				width: 100%;
				text-align: center;
				padding: 8px 0;
			}

		script(type="text/javascript").

			var bu = new Bu.App({
				canvas: {
					showKeyPoints: true,
					cursor: 'crosshair',
				},
				data: function() {
					var randomizer = new Bu.ShapeRandomizer();
					return {
						mousePos: new Bu.Point(),
						randomizer: randomizer,
					}
				},
				objects: function() {
					var lineVertical = new Bu.Line().dash();
					lineVertical.points[1].label = "T";
					return {
						line: this.randomizer.generateLine(),
						lineVertical: lineVertical,
					}
				},
				hierarchy: {
					line: {},
					lineVertical: {},
				},
				init: function() {
					this.randomizer.setRange(this.$canvas.width, this.$canvas.height);
				},
				events: {
					'mousemove': function (e) {
						var o = this.$objects;
						this.mousePos.x = e.offsetX;
						this.mousePos.y = e.offsetY;

						var dist = o.line.distanceTo(this.mousePos);
						o.lineVertical.points[0].copy(this.mousePos);
						o.line.footPointFrom(this.mousePos, o.lineVertical.points[1]);
						o.lineVertical.points[0].label = "Distance: " + Math.round(dist);
					},
					'mouseup': function (e) {
						this.$objects.line = this.$canvas.shapes[0] = this.randomizer.generateLine();
					},
				},
			});

	body
		div#info Move cursor to measure the distance. Click to change another line.
